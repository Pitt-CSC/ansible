---
- name: Create site directory
  action: file path=/u/sites/steelhacks state=directory owner=steelhacks group=steelhacks mode=0755

- name: Configure nginx sites
  action: copy src={{ item }} dest=/etc/nginx/sites-available/{{ item }}
  with_items:
    - steelhacks.pittcsc.org
    - hackpitt.pittcsc.org
  notify: Restart nginx

- name: Enable nginx sites
  action: file path=/etc/nginx/sites-enabled/{{ item }} src=/etc/nginx/sites-available/{{ item }} state=link force=yes
  with_items:
    - steelhacks.pittcsc.org
    - hackpitt.pittcsc.org
  notify: Restart nginx

- name: Allow HTTP traffic
  action: ufw direction=in proto=tcp port=80 rule=allow
  notify: Reload ufw
